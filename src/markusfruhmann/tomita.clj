(ns markusfruhmann.tomita
  (:require
   [markusfruhmann.utils :as utils]))

;; Each tomita grammars valid-words are defined using a regex representation from
;; Artificial Neural Networks and Machine Learning – ICANN 2019: Theoretical Neural Computation
;; by Igor V. Tetko, Věra Kůrková, Pavel Karpov, Fabian Theis
;; on page 315, table 1.
;; Each grammar contains 100 valid-words and 100 invalid-words.
;; The repetition of each regex function is increased to 50.

(def tomita-1-base {:valid-words ["aa"
                                  "a"
                                  "aaaaaa"
                                  "aaaaa"
                                  ""
                                  "aaa"
                                  "aaaa"]
                    :invalid-words ["ba"
                                    "bbba"
                                    "aab"
                                    "bba"
                                    "bbaaa"
                                    "bb"
                                    "aabb"
                                    "aabbab"
                                    "bbb"
                                    "aaab"
                                    "bab"
                                    "babb"
                                    "baaa"
                                    "baaaa"
                                    "b"
                                    "bbaa"
                                    "aabba"
                                    "baa"]})

(def tomita-2-base {:valid-words ["ab"
                                  "abab"]
                    :invalid-words ["bab"
                                    "baab"
                                    "abbaaaab"
                                    "abaab"
                                    "abbabbb"
                                    "abbaaa"
                                    "abbb"
                                    "bbaa"
                                    "bba"
                                    "abbab"
                                    "abbabbba"
                                    "aba"
                                    "aab"
                                    "abbaaaa"
                                    "bbaaa"
                                    "abbbaab"
                                    "abbba"
                                    "abaaaaab"
                                    "a"
                                    "abaaaa"
                                    "abbbaa"
                                    "ababa"
                                    "ba"
                                    "bbba"
                                    "bbab"
                                    "abbaaaabb"
                                    "abaa"
                                    "bbb"
                                    "abbaaab"
                                    "abaaaaa"
                                    "abb"
                                    "aababb"
                                    "bbbab"
                                    "b"
                                    "baa"
                                    "abaaa"
                                    "bb"
                                    "abbabb"
                                    "bbaaab"
                                    "aa"
                                    "aaab"
                                    "abbaa"
                                    "abbabbbab"
                                    "abba"
                                    "abaaaab"
                                    "aabab"
                                    "aaba"
                                    ""
                                    "aaa"]})

(def tomita-3-base {:valid-words ["aaabb"
                                  "baaabba"
                                  "baab"
                                  "baaabbaa"
                                  "abbaaa"
                                  "aaaaa"
                                  "bbaa"
                                  "bba"
                                  "aab"
                                  "abbaaaa"
                                  "bbaaa"
                                  "aaabbaa"
                                  "baaabbaaa"
                                  "a"
                                  "abbabbbbbb"
                                  "aaaa"
                                  "ba"
                                  "abbbbbbbb"
                                  "aaaab"
                                  "abbabbbb"
                                  "abbbbbb"
                                  "abb"
                                  "aaabba"
                                  "b"
                                  "abbbb"
                                  "abbaaaaa"
                                  "baa"
                                  "baaa"
                                  "bb"
                                  "abbabb"
                                  "aa"
                                  "abbaa"
                                  "abba"
                                  "aaabbaaa"
                                  ""
                                  "aaa"
                                  "baaabb"]
                    :invalid-words ["abbabaaa"
                                    "abbabbb"
                                    "aba"
                                    "ababaaab"
                                    "abbba"
                                    "abaababab"
                                    "abaaaaab"
                                    "abaaaa"
                                    "abaaaaaaaab"
                                    "ababa"
                                    "abaaaaaaaa"
                                    "abbaaab"
                                    "ababbaab"
                                    "ababbaaba"
                                    "abbbab"
                                    "abaaa"
                                    "ababbaaaaab"
                                    "abbabaaaa"
                                    "abab"
                                    "abaaaab"
                                    "ababbb"
                                    "abaabab"
                                    "aaaaab"
                                    "abbaaaab"
                                    "abaababa"
                                    "ababbbb"
                                    "abbabaaaaa"
                                    "abbab"
                                    "abaaabbbaa"
                                    "ababbaa"
                                    "abaaabbbaaab"
                                    "baaab"
                                    "abbabab"
                                    "abaaba"
                                    "abaaab"
                                    "ababb"
                                    "aaab"
                                    "abbabaaaaab"
                                    "ababaaa"
                                    "abbbaaa"
                                    "abaabaaab"
                                    "abaaabbba"
                                    "ababaa"
                                    "ab"
                                    "abbbaaab"
                                    "ababbaaaaa"
                                    "abaaabbb"
                                    "abbabbbbb"
                                    "abbbaa"
                                    "abaaabb"
                                    "abbaba"
                                    "abbaab"
                                    "abbbaaaab"
                                    "baaabbaaab"
                                    "abaaabbbaaa"
                                    "ababbaabab"
                                    "bbaaab"
                                    "abbbbbbb"
                                    "ababbabb"
                                    "abaaaaaa"
                                    "abbbbb"
                                    "abaaaaaaa"
                                    "abaab"
                                    "abbabaa"
                                    "ababbaaaa"
                                    "abbb"
                                    "ababaab"
                                    "ababbaaa"
                                    "abbbaab"
                                    "abaa"
                                    "abaaaaa"
                                    "abaabaaa"
                                    "ababba"
                                    "ababbab"
                                    "abaabaa"
                                    "aaabbaaab"
                                    "abbbaaaa"]})

(def tomita-4-base {:valid-words ["babbabb"
                                  "bab"
                                  "babba"
                                  "bbabb"
                                  "baab"
                                  "ab"
                                  "bba"
                                  "baba"
                                  "aab"
                                  "a"
                                  "aaaabb"
                                  "aaaa"
                                  "ba"
                                  "bbab"
                                  "aaaab"
                                  "babb"
                                  "aabaa"
                                  "abb"
                                  "b"
                                  "baa"
                                  "bb"
                                  "aabaaa"
                                  "aa"
                                  "baabb"
                                  "babbab"
                                  "aaba"
                                  ""
                                  "aaa"]
                    :invalid-words ["bbbabbaab"
                                    "bbbbaabb"
                                    "bbbbb"
                                    "bbbabbaabb"
                                    "bbbbbb"
                                    "bbabbbabbb"
                                    "bbbbaaaa"
                                    "bbbaa"
                                    "bbabbbabb"
                                    "bbba"
                                    "bbbbaa"
                                    "bbabbb"
                                    "bbbabbaa"
                                    "bbabbbab"
                                    "bbb"
                                    "bbbbaaa"
                                    "bbbab"
                                    "bbbabba"
                                    "bbbb"
                                    "bbbabb"
                                    "bbbba"
                                    "bbabbba"
                                    "aaaabbb"
                                    "bbbbaab"]})

(def tomita-5-base {:valid-words ["bbaaaa"
                                  "baba"
                                  "bb"
                                  "aa"
                                  "baab"
                                  "bbbb"
                                  "bbaa"
                                  "abba"
                                  ""
                                  "babaaa"
                                  "aaaa"]
                    :invalid-words ["bab"
                                    "baabba"
                                    "aaaaab"
                                    "bbbbb"
                                    "baaaa"
                                    "ab"
                                    "aaaaa"
                                    "baaaaa"
                                    "bba"
                                    "aaa"
                                    "bbaaaaa"
                                    "aba"
                                    "aab"
                                    "bbaaa"
                                    "aabaaaa"
                                    "a"
                                    "bbbbabb"
                                    "baaab"
                                    "ba"
                                    "abbaab"
                                    "baaaaab"
                                    "babaa"
                                    "babb"
                                    "bbb"
                                    "abb"
                                    "aabaa"
                                    "baaba"
                                    "aaba"
                                    "b"
                                    "aaaba"
                                    "baa"
                                    "baabab"
                                    "baaa"
                                    "aabaaa"
                                    "aaab"
                                    "bbbba"
                                    "bbbbab"
                                    "abbaa"
                                    "baababb"
                                    "baabb"
                                    "bbbbba"
                                    "baaabb"]})

(def tomita-6-base {:valid-words ["ba"
                                  "abbaba"
                                  "aaabbb"
                                  "aabb"
                                  "abbabaab"
                                  "bbb"
                                  "abab"
                                  "bbbaaaab"
                                  "bbbba"
                                  "bbbaaa"
                                  "abbbaa"
                                  "abba"
                                  "aabbba"
                                  "ab"
                                  ""
                                  "aaa"]
                    :invalid-words ["bab"
                                    "aaabb"
                                    "abbabaa"
                                    "abbb"
                                    "abbab"
                                    "aba"
                                    "aabbb"
                                    "aab"
                                    "abbbaab"
                                    "abbba"
                                    "bbbaa"
                                    "a"
                                    "bbbbabb"
                                    "aabbbabb"
                                    "bbbaaaa"
                                    "bbba"
                                    "abb"
                                    "b"
                                    "bb"
                                    "aa"
                                    "aaab"
                                    "bbbb"
                                    "bbbbab"
                                    "aabbbab"
                                    "aaabbbb"]})

(def tomita-7-base {:valid-words ["bab"
                                  "abaaaaaa"
                                  "aaabb"
                                  "abaaaaaaa"
                                  "ab"
                                  "abbb"
                                  "bba"
                                  "aba"
                                  "aabbb"
                                  "aab"
                                  "aabb"
                                  "abbba"
                                  "aabbba"
                                  "a"
                                  "abaaaa"
                                  "abbbaa"
                                  "ba"
                                  "bbba"
                                  "bbab"
                                  "abaa"
                                  "bbb"
                                  "abaaaaa"
                                  "abb"
                                  "aaabba"
                                  "bbbab"
                                  "b"
                                  "abbbb"
                                  "abbbba"
                                  "abaaa"
                                  "bb"
                                  "aa"
                                  "aaab"
                                  "abba"
                                  ""
                                  "aabba"
                                  "aaa"]
                    :invalid-words ["ababaabbab"
                                    "abaabbbb"
                                    "abaabb"
                                    "ababbabbbabba"
                                    "aabbab"
                                    "abaaaba"
                                    "abbababbab"
                                    "ababbbb"
                                    "abaab"
                                    "ababaa"
                                    "abaabba"
                                    "ababbabbba"
                                    "abbab"
                                    "ababaab"
                                    "abbbbab"
                                    "abbababba"
                                    "abaabbbbab"
                                    "abbbaab"
                                    "ababaabba"
                                    "abbbaaba"
                                    "ababbabbbbbba"
                                    "ababbabbbbbb"
                                    "abababba"
                                    "abababbab"
                                    "ababbabbbabbab"
                                    "ababa"
                                    "abaaaabbab"
                                    "ababab"
                                    "ababbabbbbb"
                                    "abaabbb"
                                    "ababbabbbb"
                                    "abbaba"
                                    "abbabab"
                                    "abaabbab"
                                    "ababaaaaa"
                                    "ababbabbbabb"
                                    "ababbabbbbbbab"
                                    "ababba"
                                    "ababbab"
                                    "abbababb"
                                    "aaabbab"
                                    "abaaab"
                                    "ababbbbab"
                                    "abbbab"
                                    "ababb"
                                    "ababbba"
                                    "abaaaaaaab"
                                    "abbbaabab"
                                    "ababbabbbab"
                                    "abaaabab"
                                    "ababaaaaab"
                                    "ababaabb"
                                    "ababbbab"
                                    "abaaaabba"
                                    "abababb"
                                    "abaaaabb"
                                    "abab"
                                    "abaaaab"
                                    "ababaaa"
                                    "ababbabbb"
                                    "ababbabb"
                                    "ababbb"
                                    "aabbbab"
                                    "ababaaaab"
                                    "ababaaaa"
                                    "abaabbbba"
                                    "ababbbba"]})

(def tomita-1 (utils/generate-word-map #"a*" #"(b+|a+b)+" tomita-1-base 100))

(def tomita-2 (utils/generate-word-map #"(ab)*" #"(a+|b+)*a" tomita-2-base 100))

(def tomita-3 (utils/generate-word-map #"b*(((aa)+b*)|(a(aa)*(bb)+))*a?" #"b*((((aa)+b*)|(a(aa)*(bb)+))*(a(aa)*b(bb)*)+)+a?" tomita-3-base 100))

(def tomita-4 (utils/generate-word-map #"(a|ba|bba)*(bb|b)?" #"(b*a*)*bbb(b*a*)*" tomita-4-base 100))

(def tomita-5 (utils/generate-word-map #"(aa|bb|(ab|ba)(aa|bb)*(ab|ba))*" #"(aa|bb|(ab|ba)(aa|bb)*(ab|ba))*(a|b)" tomita-5-base 100))

(def tomita-6 (utils/generate-word-map #"(ba|(a|bb)(ab)*(b|aa))*" #"(ba|(a|bb)(ab)*(b|aa))*(b|a)" tomita-6-base 100))

(def tomita-7 (utils/generate-word-map #"b*a*b*a*" #"(b+a+){3,}|(a+b+){2,}" tomita-7-base 100))
